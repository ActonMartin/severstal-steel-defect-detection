short_name: sever-cuda:0
save_dir: saved/
seed: 1234
device: 0

arch:
  type: FPN
  args:
    encoder_name: efficientnet-b5
    encoder_weights: imagenet
    classes: 4
    in_channels: 1
    activation: null
    dropout: 0.1
    weight_std: true
    decoder_merge_policy: cat

data_loader:
  type: SteelDataLoader
  args:
    batch_size: 16
    data_dir: data/raw/severstal-steel-defect-detection
    nworkers: 4
    shuffle: true
    validation_split: 0.2

augmentation: RandomCropMediumTransforms

loss:
  type: SmoothBCEDiceLoss
  args:
    bce_weight: 0.6
    dice_weight: 0.4

lr_scheduler:
  type: CosineAnnealingScheduler
  args:
    start_anneal: 50
    n_epochs: 251

metrics:
  - dice_0
  - dice_1
  - dice_2
  - dice_3
  - dice_mean

optimizer:
  type: RAdam
  lr_encoder: 0.00003
  lr_decoder: 0.003
  args:
    lr: 0.001
    weight_decay: 0.0005

training:
  early_stop: 50
  epochs: 250
  unfreeze_encoder: 0
  monitor: min val_loss
  save_period: 1
  tensorboard: true
  verbose: 2

testing:
  data_dir: data/
  batch_size: 128
  nworkers: 8
  verbose: 2


# more epochs
# decay LR later
# weight BCE heavier than Dice